{"version":3,"sources":["webpack:///src/app/login/login.page.html","webpack:///src/app/login/login-routing.module.ts","webpack:///src/app/login/login.module.ts","webpack:///src/app/login/login.page.scss","webpack:///src/app/login/login.page.ts"],"names":["routes","path","component","LoginPageRoutingModule","imports","forChild","exports","LoginPageModule","declarations","LoginPage","userService","modalController","loadingController","router","alertController","validationMessages","email","password","loginForm","required","create","modal","present","message","loading","header","buttons","alert","clearValidationMessages","validateFields","valid","user","id","authInfo","get","value","presentLoading","loadingView","login","subscribe","response","dismiss","saveUser","navigate","error","presentErrorAlert","validateEmailField","validatePasswordField","emailErrors","errors","console","log","push","passwordErrors","selector","template"],"mappings":";;;;;;;;;;;;;;;;;;;;AAAA;AAAe;;;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACKf,UAAMA,MAAM,GAAW,CACrB;AACEC,YAAI,EAAE,EADR;AAEEC,iBAAS,EAAE;AAFb,OADqB,CAAvB;;UAWaC,sBAAsB;AAAA;AAAA,O;;AAAtBA,4BAAsB,6DAJlC,+DAAS;AACRC,eAAO,EAAE,CAAC,6DAAaC,QAAb,CAAsBL,MAAtB,CAAD,CADD;AAERM,eAAO,EAAE,CAAC,4DAAD;AAFD,OAAT,CAIkC,GAAtBH,sBAAsB,CAAtB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;UCIAI,eAAe;AAAA;AAAA,O;;AAAfA,qBAAe,6DAV3B,+DAAS;AACRH,eAAO,EAAE,CACP,4DADO,EAEP,0DAFO,EAGP,kEAHO,EAIP,0DAJO,EAKP,4EALO,CADD;AAQRI,oBAAY,EAAE,CAAC,qDAAD;AARN,OAAT,CAU2B,GAAfD,eAAe,CAAf;;;;;;;;;;;;;;;;ACpBb;AAAe;;;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;UCaFE,SAAS;AAWpB,2BACUC,WADV,EAEUC,eAFV,EAGUC,iBAHV,EAIUC,MAJV,EAKUC,eALV,EAK4C;AAAA;;AAJlC,eAAAJ,WAAA,GAAAA,WAAA;AACA,eAAAC,eAAA,GAAAA,eAAA;AACA,eAAAC,iBAAA,GAAAA,iBAAA;AACA,eAAAC,MAAA,GAAAA,MAAA;AACA,eAAAC,eAAA,GAAAA,eAAA;AAdH,eAAAC,kBAAA,GAAqB;AAC1BC,iBAAK,EAAE,EADmB;AAE1BC,oBAAQ,EAAE;AAFgB,WAArB;AAIA,eAAAC,SAAA,GAAuB,IAAI,wDAAJ,CAAc;AAC1CF,iBAAK,EAAE,IAAI,0DAAJ,CAAgB,EAAhB,EAAoB,CAAC,0DAAWA,KAAZ,EAAmB,0DAAWG,QAA9B,CAApB,CADmC;AAE1CF,oBAAQ,EAAE,IAAI,0DAAJ,CAAgB,EAAhB,EAAoB,CAAC,0DAAWE,QAAZ,CAApB;AAFgC,WAAd,CAAvB;AAUwC;;AAhB3B;AAAA;AAAA,qCAkBT,CACV;AAED;;;;AArBoB;AAAA;AAAA,+CAwBO;;;;;;;;AACX,6BAAM,KAAKR,eAAL,CAAqBS,MAArB,CAA4B;AAC9ClB,iCAAS,EAAE;AADmC,uBAA5B,CAAN;;;AAARmB,2B;;AAGC,6BAAMA,KAAK,CAACC,OAAN,EAAN;;;;;;;;;;;;AACR;AAED;;;;AA/BoB;AAAA;AAAA,2CAkCW;;;;;;;;AACb,6BAAM,KAAKV,iBAAL,CAAuBQ,MAAvB,CAA8B;AAClDG,+BAAO,EAAE;AADyC,uBAA9B,CAAN;;;AAAVC,6B;;AAGN,6BAAMA,OAAO,CAACF,OAAR,EAAN;;;wDACOE,O;;;;;;;;;AACR;AAED;;;;AA1CoB;AAAA;AAAA,8CA6CM;;;;;;;;AACV,6BAAM,KAAKV,eAAL,CAAqBM,MAArB,CAA4B;AAC9CK,8BAAM,EAAE,wBADsC;AAE9CF,+BAAO,EAAE,0CAFqC;AAG9CG,+BAAO,EAAE,CAAC,SAAD;AAHqC,uBAA5B,CAAN;;;AAARC,2B;;AAMN,6BAAMA,KAAK,CAACL,OAAN,EAAN;;;;;;;;;AACD;AAED;;;;AAvDoB;AAAA;AAAA,kCA0DN;;;;;;;;;AACZ,2BAAKM,uBAAL;AACA,2BAAKC,cAAL;;2BACI,KAAKX,SAAL,CAAeY,K;;;;;AACXC,0B,GAAO;AACXC,0BAAE,EAAE,IADO;AAEXhB,6BAAK,EAAE;AAFI,uB;AAIPiB,8B,GAAW;AACfjB,6BAAK,EAAE,KAAKE,SAAL,CAAegB,GAAf,CAAmB,OAAnB,EAA4BC,KADpB;AAEflB,gCAAQ,EAAE,KAAKC,SAAL,CAAegB,GAAf,CAAmB,UAAnB,EAA+BC;AAF1B,uB;;AAIC,6BAAM,KAAKC,cAAL,EAAN;;;AAAdC,iC;AACJ,2BAAK3B,WAAL,CAAiB4B,KAAjB,CAAuBL,QAAvB,EAAiCM,SAAjC,CAA2C,UAACC,QAAD,EAAc;AACvDH,mCAAW,CAACI,OAAZ;AACAV,4BAAI,CAACf,KAAL,GAAawB,QAAQ,CAACxB,KAAtB;AACAe,4BAAI,CAACC,EAAL,GAAUQ,QAAQ,CAACR,EAAnB;AACA,2FAAUU,QAAV,CAAmBX,IAAnB;;AACA,6BAAI,CAAClB,MAAL,CAAY8B,QAAZ,CAAqB,CAAC,OAAD,CAArB;AACD,uBAND,EAMG,UAAAC,KAAK,EAAI;AACVP,mCAAW,CAACI,OAAZ;;AACA,6BAAI,CAACI,iBAAL;AACD,uBATD;;;;;;;;;AAWH;AAED;;;;AApFoB;AAAA;AAAA,oDAuFc;AAChC,iBAAK9B,kBAAL,CAAwBC,KAAxB,GAAgC,EAAhC;AACA,iBAAKD,kBAAL,CAAwBE,QAAxB,GAAmC,EAAnC;AACD;AAED;;;;AA5FoB;AAAA;AAAA,2CA+FK;AACvB,iBAAK6B,kBAAL;AACA,iBAAKC,qBAAL;AACD;AAED;;;;AApGoB;AAAA;AAAA,+CAuGS;AAC3B,gBAAMC,WAAW,GAAG,KAAK9B,SAAL,CAAegB,GAAf,CAAmB,OAAnB,EAA4Be,MAAhD;AACAC,mBAAO,CAACC,GAAR,CAAYH,WAAZ;;AACA,gBAAIA,WAAJ,EAAiB;AACf,kBAAIA,WAAW,CAAC7B,QAAhB,EAA0B;AACxB,qBAAKJ,kBAAL,CAAwBC,KAAxB,CAA8BoC,IAA9B,CAAmC,uCAAnC;AACD;;AACD,kBAAIJ,WAAW,CAAChC,KAAhB,EAAuB;AACrB,qBAAKD,kBAAL,CAAwBC,KAAxB,CAA8BoC,IAA9B,CAAmC,iDAAnC;AACD;AACF;AACF;AAED;;;;AApHoB;AAAA;AAAA,kDAuHY;AAC9B,gBAAMC,cAAc,GAAG,KAAKnC,SAAL,CAAegB,GAAf,CAAmB,UAAnB,EAA+Be,MAAtD;AACAC,mBAAO,CAACC,GAAR,CAAYE,cAAZ;;AACA,gBAAIA,cAAJ,EAAoB;AAClB,kBAAIA,cAAc,CAAClC,QAAnB,EAA6B;AAC3B,qBAAKJ,kBAAL,CAAwBE,QAAxB,CAAiCmC,IAAjC,CAAsC,+BAAtC;AACD;AACF;AACF;AA/HmB;;AAAA;AAAA,S;;;;gBARb;;gBAFoC;;gBAAnB;;gBADjB;;gBACA;;;;AAUI3C,eAAS,6DALrB,gEAAU;AACT6C,gBAAQ,EAAE,WADD;AAETC,gBAAQ,EAAR;AAAA;AAAA,4FAFS;;;;AAAA,OAAV,CAKqB,GAAT9C,SAAS,CAAT","file":"login-login-module-es5.js","sourcesContent":["export default \"<ion-content>\\n  <div class=\\\"form-content\\\">\\n    <ion-grid style=\\\"height: 100%\\\">\\n      <ion-row justify-content-center align-items-center style=\\\"height: 100%; flex-direction: column\\\">\\n        <div class=\\\"center-content\\\">\\n          <form [formGroup]=\\\"loginForm\\\" (ngSubmit)=\\\"login()\\\">\\n            <h1  class=\\\"ion-text-center\\\">Iniciar sesión</h1>\\n            <ion-item>\\n              <ion-label position=\\\"floating\\\">Correo electrónico</ion-label>\\n              <ion-input type=\\\"email\\\" formControlName=\\\"email\\\" required color=\\\"red\\\"></ion-input>\\n            </ion-item>\\n            <div *ngFor=\\\"let error of validationMessages.email\\\">\\n              <div class=\\\"error\\\">\\n                <ion-icon name=\\\"alert\\\" color=\\\"danger\\\"></ion-icon>\\n                <ion-text color=\\\"danger\\\">{{ error }}</ion-text>\\n              </div>\\n            </div>\\n            <ion-item>\\n              <ion-label position=\\\"floating\\\">Contraseña</ion-label>\\n              <ion-input type=\\\"password\\\" formControlName=\\\"password\\\" required></ion-input>\\n            </ion-item>\\n            <div *ngFor=\\\"let error of validationMessages.password\\\">\\n              <div class=\\\"error\\\">\\n                <ion-icon name=\\\"alert\\\" color=\\\"danger\\\"></ion-icon>\\n                <ion-text color=\\\"danger\\\">{{ error }}</ion-text>\\n              </div>\\n            </div>\\n            <div class=\\\"ion-padding\\\">\\n              <ion-button expand=\\\"block\\\" type=\\\"submit\\\" class=\\\"ion-no-margin\\\">Iniciar sesión\\n              </ion-button>\\n              <ion-button expand=\\\"block\\\" class=\\\"ion-no-margin\\\" color=\\\"tertiary\\\" (click)=\\\"presentSignUpModal()\\\">Crear\\n                cuenta</ion-button>\\n            </div>\\n          </form>\\n        </div>\\n      </ion-row>\\n    </ion-grid>\\n  </div>\\n</ion-content>\";","import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { LoginPage } from './login.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: LoginPage\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class LoginPageRoutingModule {}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule, ReactiveFormsModule } from '@angular/forms';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { LoginPageRoutingModule } from './login-routing.module';\n\nimport { LoginPage } from './login.page';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    ReactiveFormsModule,\n    IonicModule,\n    LoginPageRoutingModule\n  ],\n  declarations: [LoginPage]\n})\nexport class LoginPageModule {}\n","export default \":root {\\n  --ion-safe-area-top: 20px;\\n  --ion-safe-area-bottom: 22px;\\n}\\n\\n.form-content {\\n  background: url('shapes.svg') no-repeat;\\n  background-size: cover;\\n  height: 100%;\\n}\\n\\nion-content {\\n  --overflow: hidden;\\n}\\n\\nh1 {\\n  margin: 0;\\n  margin-top: 10px;\\n  padding: 0;\\n}\\n\\n.center-content {\\n  width: 100%;\\n  height: 100%;\\n  display: flex;\\n  justify-content: center;\\n  align-items: center;\\n}\\n\\nform {\\n  background-color: white;\\n  padding: 20px;\\n  border-radius: 10px;\\n  box-shadow: 0 0 10px 2px rgba(0, 0, 0, 0.2);\\n  width: 90%;\\n  max-width: 400px;\\n}\\n\\nform .error {\\n  margin: 10px;\\n}\\n\\nform .error ion-icon {\\n  margin-right: 10px;\\n}\\n\\nion-button {\\n  margin-top: 15px;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvbG9naW4vbG9naW4ucGFnZS5zY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0VBQ0kseUJBQUE7RUFDQSw0QkFBQTtBQUNKOztBQUVBO0VBQ0ksdUNBQUE7RUFDQSxzQkFBQTtFQUNBLFlBQUE7QUFDSjs7QUFFQTtFQUNJLGtCQUFBO0FBQ0o7O0FBRUE7RUFDSSxTQUFBO0VBQ0EsZ0JBQUE7RUFDQSxVQUFBO0FBQ0o7O0FBRUE7RUFDSSxXQUFBO0VBQ0EsWUFBQTtFQUNBLGFBQUE7RUFDQSx1QkFBQTtFQUNBLG1CQUFBO0FBQ0o7O0FBRUE7RUFDSSx1QkFBQTtFQUNBLGFBQUE7RUFDQSxtQkFBQTtFQUNBLDJDQUFBO0VBQ0EsVUFBQTtFQUNBLGdCQUFBO0FBQ0o7O0FBQ0k7RUFDSSxZQUFBO0FBQ1I7O0FBQ1E7RUFDSSxrQkFBQTtBQUNaOztBQUlBO0VBQ0ksZ0JBQUE7QUFESiIsImZpbGUiOiJzcmMvYXBwL2xvZ2luL2xvZ2luLnBhZ2Uuc2NzcyIsInNvdXJjZXNDb250ZW50IjpbIjpyb290IHtcbiAgICAtLWlvbi1zYWZlLWFyZWEtdG9wOiAyMHB4O1xuICAgIC0taW9uLXNhZmUtYXJlYS1ib3R0b206IDIycHg7XG59XG5cbi5mb3JtLWNvbnRlbnQge1xuICAgIGJhY2tncm91bmQ6IHVybChcIi4uLy4uL2Fzc2V0cy9zaGFwZXMuc3ZnXCIpIG5vLXJlcGVhdDtcbiAgICBiYWNrZ3JvdW5kLXNpemU6IGNvdmVyO1xuICAgIGhlaWdodDogMTAwJTtcbn1cblxuaW9uLWNvbnRlbnQge1xuICAgIC0tb3ZlcmZsb3c6IGhpZGRlbjtcbn1cblxuaDEge1xuICAgIG1hcmdpbjogMDtcbiAgICBtYXJnaW4tdG9wOiAxMHB4O1xuICAgIHBhZGRpbmc6IDA7XG59XG5cbi5jZW50ZXItY29udGVudCB7XG4gICAgd2lkdGg6IDEwMCU7XG4gICAgaGVpZ2h0OiAxMDAlO1xuICAgIGRpc3BsYXk6IGZsZXg7XG4gICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7XG4gICAgYWxpZ24taXRlbXM6IGNlbnRlcjtcbn1cblxuZm9ybSB7XG4gICAgYmFja2dyb3VuZC1jb2xvcjogd2hpdGU7XG4gICAgcGFkZGluZzogMjBweDtcbiAgICBib3JkZXItcmFkaXVzOiAxMHB4O1xuICAgIGJveC1zaGFkb3c6IDAgMCAxMHB4IDJweCByZ2JhKDAsIDAsIDAsIDAuMik7XG4gICAgd2lkdGg6IDkwJTtcbiAgICBtYXgtd2lkdGg6IDQwMHB4O1xuXG4gICAgLmVycm9yIHtcbiAgICAgICAgbWFyZ2luOiAxMHB4O1xuXG4gICAgICAgIGlvbi1pY29uIHtcbiAgICAgICAgICAgIG1hcmdpbi1yaWdodDogMTBweDtcbiAgICAgICAgfVxuICAgIH1cbn1cblxuaW9uLWJ1dHRvbiB7XG4gICAgbWFyZ2luLXRvcDogMTVweDtcbn0iXX0= */\";","import { Component, OnInit } from '@angular/core';\nimport { FormControl, FormGroup, Validators } from '@angular/forms';\nimport { Router } from '@angular/router';\nimport { AlertController, LoadingController, ModalController } from '@ionic/angular';\nimport { AuthGuard } from 'src/resources/auth-guard';\nimport { UserService } from 'src/services/user.service';\nimport { RegisterPage } from '../register/register.page';\n\n@Component({\n  selector: 'app-login',\n  templateUrl: './login.page.html',\n  styleUrls: ['./login.page.scss'],\n})\nexport class LoginPage implements OnInit {\n\n  public validationMessages = {\n    email: [],\n    password: []\n  };\n  public loginForm: FormGroup = new FormGroup({\n    email: new FormControl('', [Validators.email, Validators.required]),\n    password: new FormControl('', [Validators.required])\n  });\n\n  constructor(\n    private userService: UserService,\n    private modalController: ModalController,\n    private loadingController: LoadingController,\n    private router: Router,\n    private alertController: AlertController) { }\n\n  ngOnInit() {\n  }\n\n  /**\n   * Muestra la vista para hacer el registro de usuario.\n   */\n  async presentSignUpModal() {\n    const modal = await this.modalController.create({\n      component: RegisterPage\n    });\n    return await modal.present();\n  }\n\n  /**\n   * Presenta una vista con un spinner.\n   */\n  private async presentLoading() {\n    const loading = await this.loadingController.create({\n      message: 'Iniciando sesión'\n    });\n    await loading.present();\n    return loading;\n  }\n\n  /**\n   * Presenta una alerta de error\n   */\n  async presentErrorAlert() {\n    const alert = await this.alertController.create({\n      header: 'Credenciales inválidas',\n      message: 'El correo o la contraseña son inválidos.',\n      buttons: ['Aceptar']\n    });\n\n    await alert.present();\n  }\n\n  /**\n   * Ejecuta el login del usuario enviando el correo y la contraseña al servidor.\n   */\n  async login() {\n    this.clearValidationMessages();\n    this.validateFields();\n    if (this.loginForm.valid) {\n      const user = {\n        id: null,\n        email: null\n      };\n      const authInfo = {\n        email: this.loginForm.get('email').value,\n        password: this.loginForm.get('password').value\n      };\n      let loadingView = await this.presentLoading();\n      this.userService.login(authInfo).subscribe((response) => {\n        loadingView.dismiss();\n        user.email = response.email;\n        user.id = response.id;\n        AuthGuard.saveUser(user);\n        this.router.navigate(['/tabs']);\n      }, error => {\n        loadingView.dismiss();\n        this.presentErrorAlert();\n      });\n    }\n  }\n\n  /**\n   * Limpia los mensajes de error.\n   */\n  private clearValidationMessages() {\n    this.validationMessages.email = [];\n    this.validationMessages.password = [];\n  }\n\n  /**\n   * Valida que los campos tengan información válida.\n   */\n  private validateFields() {\n    this.validateEmailField();\n    this.validatePasswordField();\n  }\n\n  /**\n   * Valida la información que contiene el campo de email.\n   */\n  private validateEmailField() {\n    const emailErrors = this.loginForm.get('email').errors;\n    console.log(emailErrors);\n    if (emailErrors) {\n      if (emailErrors.required) {\n        this.validationMessages.email.push('El correo electrónico es obligatorio.');\n      }\n      if (emailErrors.email) {\n        this.validationMessages.email.push('El formato del correo electrónico no es válido.');\n      }\n    }\n  }\n\n  /**\n   * Valida la información que contiene el campo de contraseña.\n   */\n  private validatePasswordField() {\n    const passwordErrors = this.loginForm.get('password').errors;\n    console.log(passwordErrors);\n    if (passwordErrors) {\n      if (passwordErrors.required) {\n        this.validationMessages.password.push('La contraseña es obligatoria.');\n      }\n    }\n  }\n\n}\n"]}